# TIL Template

## 날짜: 2024-02-17

### 스크럼
- 학습 목표 1 : 오늘 수업 학습 (쿠키, 세션)
- 학습 목표 2 : 3주차 과제 시작

### 새로 배운 내용
키워드 정리 (핑크 - 생소한 키워드)

| **개념** | **설명** | **비고**                                                                                                                                                      |
| --- | --- |-------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 쿠키 | 웹 사이트 사용 정보를 서버의 요청에 의해 사용자의 컴퓨터에 파일로 저장하는 것 | `사용이유` : 사용자의 웹 사이트 방문정보를 기억해, 더 편리한 사용자 경험을 제공                                                                                                               |
| 퍼스트파티 쿠키 | 사용자가 직접 방문한 웹사이트(동일한 도메인)의 서버가 생성하고 저장한 쿠키 | `사용이유` : 사용자 경험 개선                                                                                                                                            |
| 서드파티 쿠키 | 사용자가 직접 방문하지 않은 웹사이트(다른 도메인)의 서버에서 생성하고 저장한 쿠키 | `사용이유` : 개인 맞춤형 광고 제공, 웹 분석을 위하여, 광고네트워크나 소셜 미디어 플랫폼 등에서 설정.                                                                                                  |
| 세션 | 컴퓨터 프로세스 간, 연결과 데이터 송수신까지의 상태정보 | `사용이유` : 사용자의 웹 사이트 이용정보를 서버에 관리하여 보안을 강화하고, 사용자 맞춤 정보를 제공<br/>`사용방법` : 사용자 별 고유의 세션을 생성하여 서버에 저장하고, 브라우저는 세션의 아이디를 사용하여 서버와 통신 <br/>→ 브라우저는 `쿠키`를 이용하여 세션의 아이디를 저장할 수 있음 |
| 로컬 스토리지 | 웹 브라우저 창을 닫아도 데이터가 유지되는 지속적인 저장 장치 | `사용이유` : 장기적으로 유지되어야 하는 데이터를 저장하여, 사용자 경험을 향상시키기 위해                                                                                                           <br/>`예시` : 사용자 설정, 테마, 즐겨찾기 |
| 세션 스토리지 | 웹 브라우저 창을 닫으면 데이터가 삭제되는 저장 장치 | `사용이유` : 일시적인 데이터를 저장하여, 사용자 경험을 향상시키기 위해                                                                                                                     <br/>`예시` : 사용자 정보, 폼 입력값 임시저장, 페이지 설정 |
|  |  | 스토리지는 클라이언트 측에서만 접근 가능     

<br>

**📍 쿠키 보안 속성**

`HttpOnly`
- 자바스크립트로 쿠키에 접근하는 것을 차단시키고, HTTP 통신을 통해서만 쿠키에 접근할 수 있도록 하는 설정
- XSS 공격 방지 (공격자가 악성 스크립트를 추가하여, 사용자의 쿠키 탈취)

`Secure`
- HTTPS 통신을 통해서만 쿠키에 접근할 수 있다. (보안된 통신)
- MITM 공격 방지 (서버의 응답을 탈취)

`SameSite`
- 서드 파티 쿠키의 전송 범위를 제한하여 보안을 강화한다.
- CSRF 공격 방지 (Cross-Site Request Forgery; 인증된 세션을 이용하여, 공격자가 악의적인 요청을 서버에 보낸다.)
- 거의 대부분의 브라우저에서 기본 설정옵션을 ‘Lax’ 로 설정한다

<br>

**📍 세션 ID와 쿠키의 관계**  
- `세션ID` : 서버 측에 저장된 세션의 고유한 아이디  
- `쿠키` : 서버에 의해 클라이언트 측에 저장되는 사용자 정보  
→ 서버는 쿠키에 **세션 ID(Session ID)** 를 저장하고, 클라이언트가 요청할 때마다 이를 함께 보냅니다. 서버는 이 세션 ID를 확인하여 **세션 저장소에서 해당 사용자의 정보를 조회**합니다. 이렇게 하면 사용자의 로그인 상태나 장바구니 정보 등을 유지할 수 있습니다.

<br>

**📍 (선택) HTTP가 본질적으로 Stateless하다는 의미와, 웹 애플리케이션에서 상태 유지를 위해 어떤 기법(예: 세션, 쿠키)을 사용하는지 설명해 주세요.**

_HTTP가 본질적으로 Stateless 하다는 의미는_
-  이전 요청의 상태를 기억하지 않고, 모든 요청을 독립적으로 처리한다는 의미이다.
    

_웹 어플리케이션에서 상태 유지를 위해 어떤 기법을 사용하냐면 …_
- 쿠키 : 클라이언트 측에 쿠키를 저장하여, 서버에 요청마다 함께 전송
쿠키에는 이런 것들을 저장한다.

  - `데이터` - 상태유지에 필요한 데이터를 저장
  - `세션ID` - 서버에 저장된 세션의 고유 아이디를 저장. 서버가 아이디로 세션을 조회하여 사용
  - `JWT` - 인증의 기능을 하는 토큰을 저장

-  세션 : 서버의 세션 저장소에 사용자별 고유의 세션이 저장된다. 클라이언트는 세션ID를 쿠키에 포함하여 요청을 보낸다.

<br>

**📍(선택) 매 요청 시 쿠키가 전송됨에 따른 네트워크 오버헤드 문제와, 이를 완화할 수 있는 방법에는 어떤 것이 있는지 논의해 주세요.**

**네트워크 오버헤드**  
현재의 모든 쿠키가 브라우저에 의해 자동으로 매 요청마다 서버로 전송된다. 이는 불필요한 상황에서의 전송이 있을 수 있으며, JWT 기반 인증 과정에서 크기가 큰 토큰을 쿠키에 저장하는 것으로 성능이 많이 저하될 수 있다.

**완화할 방법**
1. 쿠키의 **크기를** 줄인다: JWT대신 세션을 사용한다  
   → 이는 네트워크 오버헤드는 줄일 수 있지만, 서버 측의 과부화 문제를 가져온다 (트레이드 오프)  
   서버 측의 성능 부담이 더 크기 때문에 적절한 방안이 아님

2. 쿠키 **전송을 제한**한다.
    1. 특정 API 요청에는 쿠키 안보내기
        1. `fetch` 요청 중 쿠키를 포함하지 않을 요청에 `Credentials` 설정
        2. 정적인 리소스 요청에 쿠키를 포함하지 않도록 설정

        ```jsx
        // ✅ 쿠키 불포함 (정적 리소스)
        fetch('/static/style.css', {
          method: 'GET',
          credentials: 'omit'  // 쿠키 포함 안 함
        });
        
        // ✅ 쿠키 포함
        fetch('/api/user', {
          method: 'GET',
          credentials: 'include'  // 쿠키 포함
        });
        ```

    2. 특정 API 요청에만 쿠키를 보내기

       쿠키의 `Domain`과 `Path`를 적절하게 설정하여, 특정 요청에만 전송되도록 제한

        - 쿠키의 `Path` 속성을 `/api`로 설정하여 **API 요청에서만 쿠키가 전송되도록 제한**
        - 쿠키의 `Domain`을 특정 서브도메인으로 제한하여 **불필요한 사이트 간 전송 방지**

        ```jsx
        // ✅ 쿠키가 API 요청에만 전송되도록 설정
        document.cookie = "session_id=abcd1234; Path=/api; Secure; HttpOnly";
        
        ```

    3. HTTP/2 또는 HTTP/3 사용 (네트워크 최적화)

       최신 HTTP 프로토콜에서 지원하는 헤더 압축과 멀티플렉싱을 이용하자!

        - 헤더 압축
            - **HTTP/1.1**에서는 각 요청마다 **헤더가 압축 없이 전송**되어, 중복된 헤더 정보로 인해 **네트워크 대역폭이 낭비**
            - **HTTP/2**에서는 **HPACK**이라는 헤더 압축 방식을 도입하여, **중복되는 헤더 필드를 효율적으로 압축**. 이를 통해 **전송 데이터의 크기를 줄여 네트워크 효율성을 향상**
        - 멀티플렉싱
            - **HTTP/1.1**에서는 **한 연결당 하나의 요청**만 처리할 수 있어, 여러 요청을 동시에 처리하려면 **다수의 연결이 필요**.
            - **HTTP/2**에서는 **단일 TCP 연결 내에서 여러 스트림을 동시에 처리**할 수 있는 멀티플렉싱을 지원하여, **병렬 요청을 효율적으로 처리**합니다. 이를 통해 **연결 수를 줄이고 지연 시간을 감소**시켜 네트워크 성능을 향상시킵니다.

### 오늘의 회고
- 오늘도 수업량이 만만치 않아서 다하니 거의 12시가 되었다 
- 물론 오늘은 운동도 하고 그래서 그랫지만 ..
- 그래도 아직 덜 피곤하니 이론정리는 이쯤하구 새벽에는 과제를 시작해야겠다 ! 